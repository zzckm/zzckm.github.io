<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<script>
    (function(){
        if(''){
            if (prompt('请输入查看该篇文章的密码') !== ''){
                alert('密码错误，请咨询博主');
                history.back();
            }
        }
    })();
</script>


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "39f09b08"
    });
  daovoice('update');
  </script>















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="ELK,">










<meta name="description" content="ELK安装文档1. 安装准备 1.1 操作环境操作系统环境：Centos7 1708版本 JDK版本：jdk-8u144-linux-x64.tar.gz Elasticsearch版本：5.6.3 Logstash版本：5.6.3 Kibana版本：5.6.32. 安装上传文件和下载文件的插件（可以不安装） 鉴于Elasticsearch用户只能是非root用户，因此后面的所有操作都在es账户下">
<meta name="keywords" content="ELK">
<meta property="og:type" content="article">
<meta property="og:title" content="ELK安装文档">
<meta property="og:url" content="http://yoursite.com/2019/04/25/1_ELK安装文档__/index.html">
<meta property="og:site_name" content="To树-HOME">
<meta property="og:description" content="ELK安装文档1. 安装准备 1.1 操作环境操作系统环境：Centos7 1708版本 JDK版本：jdk-8u144-linux-x64.tar.gz Elasticsearch版本：5.6.3 Logstash版本：5.6.3 Kibana版本：5.6.32. 安装上传文件和下载文件的插件（可以不安装） 鉴于Elasticsearch用户只能是非root用户，因此后面的所有操作都在es账户下">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/psxk09q4hdm57j07beib6h3p/image_1btt80jm0qspmmrk121ksqp559.png">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/f6ich2owz7dnzerr0t0t6mep/image_1btt9a90v8qaqfo1a5i130htnm.png">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/rhssfvrdloocdimd8tcvt4ln/image_1btta457a3d01e371c3fn3c1dav13.png">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/jbknyal00b9licrsl01ekc5h/image_1btta50r5vikqra135r1dv7lfp20.png">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/4a1srf8cinw3a5mqdn964gyw/image_1bttcndg518kq1enu8tg3v14f32d.png">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/92eyje4tnjw7wa51bruesb9n/image_1bttcvo60152g36i5oa19ei1u7v2q.png">
<meta property="og:image" content="http://static.zybuluo.com/zhangwen100/cfwumzoreip8u0snqqu0ajcc/image_1c12nrt1g12vc1na5nki1isrfoc16.png">
<meta property="og:updated_time" content="2019-05-26T08:58:42.531Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ELK安装文档">
<meta name="twitter:description" content="ELK安装文档1. 安装准备 1.1 操作环境操作系统环境：Centos7 1708版本 JDK版本：jdk-8u144-linux-x64.tar.gz Elasticsearch版本：5.6.3 Logstash版本：5.6.3 Kibana版本：5.6.32. 安装上传文件和下载文件的插件（可以不安装） 鉴于Elasticsearch用户只能是非root用户，因此后面的所有操作都在es账户下">
<meta name="twitter:image" content="http://static.zybuluo.com/zhangwen100/psxk09q4hdm57j07beib6h3p/image_1btt80jm0qspmmrk121ksqp559.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/04/25/1_ELK安装文档__/">





  <title>ELK安装文档 | To树-HOME</title>
  









<!-- katex样式 -->
  <link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet">
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
  <a href="https://github.com/zzckm" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">To树-HOME</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">千客云起时</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/25/1_ELK安装文档__/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ckm_zz">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/ggg.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="To树-HOME">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ELK安装文档</h1>
        

        <div class="post-meta">
        <!-- TOP -->
        

          <span class="post-time">
            

            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2019-05-26T16:58:42+08:00">
                2019-05-26
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ELK日志分析平台/" itemprop="url" rel="index">
                    <span itemprop="name">ELK日志分析平台</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv">
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5.8k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  25 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="ELK安装文档"><a href="#ELK安装文档" class="headerlink" title="ELK安装文档"></a><strong>ELK安装文档</strong></h2><h1 id="1-安装准备"><a href="#1-安装准备" class="headerlink" title="1. 安装准备"></a>1. 安装准备</h1><hr>
<h2 id="1-1-操作环境"><a href="#1-1-操作环境" class="headerlink" title="1.1 操作环境"></a>1.1 操作环境</h2><pre><code>操作系统环境：Centos7 1708版本
JDK版本：jdk-8u144-linux-x64.tar.gz
Elasticsearch版本：5.6.3
Logstash版本：5.6.3
Kibana版本：5.6.3</code></pre><h1 id="2-安装上传文件和下载文件的插件（可以不安装）"><a href="#2-安装上传文件和下载文件的插件（可以不安装）" class="headerlink" title="2. 安装上传文件和下载文件的插件（可以不安装）"></a>2. 安装上传文件和下载文件的插件（可以不安装）</h1><hr>
<p>鉴于Elasticsearch用户只能是非root用户，因此后面的所有操作都在es账户下执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# yum -y install lrzsz</span><br></pre></td></tr></table></figure>

<h1 id="3-安装sudo命令并配置"><a href="#3-安装sudo命令并配置" class="headerlink" title="3. 安装sudo命令并配置"></a>3. 安装sudo命令并配置</h1><hr>
<p>由于这里采用的是最小化安装，因此sudo命令不可用。</p>
<h2 id="3-1-安装sudo插件"><a href="#3-1-安装sudo插件" class="headerlink" title="3.1 安装sudo插件"></a>3.1 安装sudo插件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# yum -y install sudo</span><br></pre></td></tr></table></figure>

<h2 id="3-2-修改-etc-sudoers文件的权限"><a href="#3-2-修改-etc-sudoers文件的权限" class="headerlink" title="3.2 修改/etc/sudoers文件的权限"></a>3.2 修改<code>/etc/sudoers</code>文件的权限</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# chmod u+w /etc/sudoers</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhiyou100.abstrac;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> width = <span class="number">100</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		USB.read();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-开始编辑-etc-sudoers文件"><a href="#3-3-开始编辑-etc-sudoers文件" class="headerlink" title="3.3 开始编辑/etc/sudoers文件"></a>3.3 开始编辑<code>/etc/sudoers</code>文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# vi /etc/sudoers</span><br></pre></td></tr></table></figure>

<h2 id="3-4-找到root-ALL-ALL-ALL行，在下面添加如下内容"><a href="#3-4-找到root-ALL-ALL-ALL行，在下面添加如下内容" class="headerlink" title="3.4 找到root    ALL=(ALL)       ALL行，在下面添加如下内容"></a>3.4 找到<code>root    ALL=(ALL)       ALL</code>行，在下面添加如下内容</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">es      ALL=(ALL)       NOPASSWD: ALL</span><br></pre></td></tr></table></figure>

<h2 id="3-5-去掉-wheel-ALL-ALL-NOPASSWD-ALL的-号"><a href="#3-5-去掉-wheel-ALL-ALL-NOPASSWD-ALL的-号" class="headerlink" title="3.5 去掉#%wheel  ALL=(ALL)         NOPASSWD: ALL的#号"></a>3.5 去掉<code>#%wheel  ALL=(ALL)         NOPASSWD: ALL</code>的#号</h2><h2 id="3-6-保存并退出"><a href="#3-6-保存并退出" class="headerlink" title="3.6 保存并退出"></a>3.6 保存并退出</h2><h2 id="3-7将es用户调整至wheel用户组中，这样以后使用sudo命令的时候就不用输入密码了。"><a href="#3-7将es用户调整至wheel用户组中，这样以后使用sudo命令的时候就不用输入密码了。" class="headerlink" title="3.7将es用户调整至wheel用户组中，这样以后使用sudo命令的时候就不用输入密码了。"></a>3.7将es用户调整至wheel用户组中，这样以后使用sudo命令的时候就不用输入密码了。</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# gpasswd -a es wheel</span><br></pre></td></tr></table></figure>

<h2 id="3-8-恢复-etc-sudoers文件的权限"><a href="#3-8-恢复-etc-sudoers文件的权限" class="headerlink" title="3.8 恢复/etc/sudoers文件的权限"></a>3.8 恢复<code>/etc/sudoers</code>文件的权限</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# chmod u-w /etc/sudoers</span><br></pre></td></tr></table></figure>

<p>然后你就可以肆无忌惮的使用es用户了</p>
<h2 id="4-切换至es用户"><a href="#4-切换至es用户" class="headerlink" title="#4. 切换至es用户"></a>#4. 切换至<code>es</code>用户</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@slave3 ~]# su es</span><br></pre></td></tr></table></figure>

<h2 id="5-创建相应目录"><a href="#5-创建相应目录" class="headerlink" title="#5. 创建相应目录"></a>#5. 创建相应目录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[es@master ~]$ sudo mkdir -p /opt/SoftWare/Java</span><br><span class="line">[es@master ~]$ sudo mkdir -p /opt/SoftWare/ES</span><br><span class="line">[es@master ~]$ sudo mkdir -p /opt/SoftWare/Kibana</span><br><span class="line">[es@master ~]$ sudo mkdir -p /opt/SoftWare/Logstash</span><br></pre></td></tr></table></figure>

<h2 id="6-关闭防火墙"><a href="#6-关闭防火墙" class="headerlink" title="#6. 关闭防火墙"></a>#6. 关闭防火墙</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[es@master Java]$ sudo systemctl stop firewalld</span><br><span class="line">[es@master Java]$ sudo systemctl disable firewalld.service</span><br></pre></td></tr></table></figure>

<h2 id="7-安装jdk环境"><a href="#7-安装jdk环境" class="headerlink" title="#7. 安装jdk环境"></a>#7. 安装jdk环境</h2><h2 id="7-1-上传tar包"><a href="#7-1-上传tar包" class="headerlink" title="7.1 上传tar包"></a>7.1 上传tar包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[es@master Java]$ sudo rz</span><br></pre></td></tr></table></figure>

<h2 id="7-1-卸载JDK"><a href="#7-1-卸载JDK" class="headerlink" title="7.1 卸载JDK"></a>7.1 卸载JDK</h2><h2 id="7-2-解压jdk"><a href="#7-2-解压jdk" class="headerlink" title="7.2 解压jdk"></a>7.2 解压jdk</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[es@master Java]$ sudo tar -zxvf jdk-8u144-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="7-3-配置环境变量"><a href="#7-3-配置环境变量" class="headerlink" title="7.3 配置环境变量"></a>7.3 配置环境变量</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[es@master Java]$ sudo vi /etc/profile</span><br></pre></td></tr></table></figure>

<p>添加一下内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">JDK1.8</span></span><br><span class="line">export JAVA_HOME=/opt/SoftWare/Java/jdk1.8.0_144</span><br><span class="line">export JRE_HOME=/opt/SoftWare/Java/jdk1.8.0_144/jre</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br></pre></td></tr></table></figure>

<p>使修改生效</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[es@master Java]$ source /etc/profile</span><br></pre></td></tr></table></figure>

<h2 id="7-4-将master节点上的jdk远程拷贝到其他节点上"><a href="#7-4-将master节点上的jdk远程拷贝到其他节点上" class="headerlink" title="7.4 将master节点上的jdk远程拷贝到其他节点上"></a>7.4 将master节点上的jdk远程拷贝到其他节点上</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[es@master Java]$ sudo scp -r jdk1.8.0_144 root@192.168.100.101:/opt/SoftWare/Java/</span><br><span class="line">[es@master Java]$ sudo scp -r jdk1.8.0_144 root@192.168.100.102:/opt/SoftWare/Java/</span><br><span class="line">[es@master Java]$ sudo scp -r jdk1.8.0_144 root@192.168.100.103:/opt/SoftWare/Java/</span><br></pre></td></tr></table></figure>

<h2 id="8-Elasticsearch的安装"><a href="#8-Elasticsearch的安装" class="headerlink" title="#8. Elasticsearch的安装"></a>#8. Elasticsearch的安装</h2><p>Elasticsearch的安装比较简单，但是有一些细节要注意，在这里咱们采用tar包进行安装</p>
<h2 id="8-1-将Elasticsearch上传至VM"><a href="#8-1-将Elasticsearch上传至VM" class="headerlink" title="8.1 将Elasticsearch上传至VM"></a>8.1 将Elasticsearch上传至VM</h2><p>可以在命令行中输入<code>rz</code>调出上传窗口即可：如<code>[root@master ES]# rz</code>。</p>
<h2 id="8-2-解压Elasticsearch压缩包"><a href="#8-2-解压Elasticsearch压缩包" class="headerlink" title="8.2 解压Elasticsearch压缩包"></a>8.2 解压Elasticsearch压缩包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ES]# tar zxvf elasticsearch-5.6.3.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="8-3-创建相关目录并赋权限给es"><a href="#8-3-创建相关目录并赋权限给es" class="headerlink" title="8.3 创建相关目录并赋权限给es"></a>8.3 创建相关目录并赋权限给es</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# mkdir -p /var/elasticsearch/log</span><br><span class="line">[root@master ~]# mkdir -p /var/elasticsearch/data</span><br><span class="line">[root@master ~]# mkdir -p /var/elasticsearch/plugins</span><br><span class="line">[root@master ~]# chown -R es:es /opt/SoftWare/ES/elasticsearch-5.6.3</span><br><span class="line">[root@master ~]# chown -R es:es /var/elasticsearch/log</span><br><span class="line">[root@master ~]# chown -R es:es /var/elasticsearch/data</span><br><span class="line">[root@master ~]# chown -R es:es /var/elasticsearch/plugins</span><br></pre></td></tr></table></figure>

<h2 id="8-4-配置核心文件"><a href="#8-4-配置核心文件" class="headerlink" title="8.4 配置核心文件"></a>8.4 配置核心文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################## Cluster ################################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 代表一个集群,集群中有多个节点,其中有一个为主节点,这个主节点是可以通过选举产生的,主从节点是对于集群内部来说的. </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> es的一个概念就是去中心化,字面上理解就是无中心节点,这是对于集群外部来说的,因为从外部来看es集群,在逻辑上是个整体,你与任何一个节点的通信和与整个es集群通信是等价的。 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster.name可以确定集群名称,当elasticsearch集群在同一个网段中,elasticsearch会自动的找到具有相同cluster.name的elasticsearch服务,这个时候需要开启多播服务才行（不建议）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 所以当同一个网段具有多个elasticsearch集群时cluster.name就成为同一个集群的标识. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">此为必须修改项</span></span><br><span class="line">cluster.name: zhiyou </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################### Node ##################################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点名称同理,可自动生成也可手动配置. （建议手动配置）</span></span><br><span class="line">node.name: node0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许此节点是否可以成为一个master节点,es是默认集群中的第一台机器为master,如果这台机器停止就会重新选举master. 在新版本中默认没有此参数，但是可以直接写上，不写默认为<span class="literal">true</span></span></span><br><span class="line">node.master: true </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许该节点存储数据(默认开启，同上) </span></span><br><span class="line">node.data: true </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置文件中给出了三种配置高性能集群拓扑结构的模式,如下： </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1. 如果你想让节点从不选举为主节点,只用来存储数据,可作为负载器 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.master: <span class="literal">false</span> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.data: <span class="literal">true</span> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.ingest: <span class="literal">true</span>  <span class="comment">#默认true</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 如果想让节点成为主节点,且不存储任何数据,并保有空闲资源,可作为协调器 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.master: <span class="literal">true</span> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.data: <span class="literal">false</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.ingest: <span class="literal">true</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 如果想让节点既不称为主节点,又不成为数据节点,那么可将他作为搜索器,从节点中获取数据,生成搜索结果等 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.master: <span class="literal">false</span> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.data: <span class="literal">false</span> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.ingest: <span class="literal">true</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. 仅作为协调器 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.master: <span class="literal">false</span> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.data: <span class="literal">false</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.ingest: <span class="literal">false</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 监控集群状态有一下插件和API可以使用: </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 每个节点都可以定义一些与之关联的通用属性，用于后期集群进行碎片分配时的过滤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> node.rack: rack314 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置一台服务器能运行的节点数,一般为1就好,因为一般情况下一台机器只跑一个节点</span></span><br><span class="line">node.max_local_storage_nodes: 1 </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################### Index #################################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置索引的分片数,默认为5 </span></span><br><span class="line">index.number_of_shards: 5 </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置索引的副本数,默认为1: </span></span><br><span class="line">index.number_of_replicas: 2 </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置文件中提到的最佳实践是,如果服务器够多,可以将分片提高,尽量将数据平均分布到大集群中去</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 同时,如果增加副本数量可以有效的提高搜索性能 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 需要注意的是,<span class="string">"number_of_shards"</span> 是索引创建后一次生成的,后续不可更改设置 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">"number_of_replicas"</span> 是可以通过API去实时修改设置的 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################### Paths #################################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置文件存储位置 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> path.conf: /path/to/conf </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 数据存储位置(单个目录设置) </span></span><br><span class="line">path.data: /var/elasticsearch/data </span><br><span class="line"><span class="meta">#</span><span class="bash"> 多个数据存储位置,有利于性能提升 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> path.data: /path/to/data1,/path/to/data2 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 临时文件的路径 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> path.work: /path/to/work </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志文件的路径 </span></span><br><span class="line">path.logs: /var/elasticsearch/log </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 插件安装路径 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> path.plugins: /var/elasticsearch/plugins </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################## Memory #################################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当JVM开始写入交换空间时（swapping）ElasticSearch性能会低下,你应该保证它不会写入交换空间 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置这个属性为<span class="literal">true</span>来锁定内存,同时也要允许elasticsearch的进程可以锁住内存,linux下可以通过 `<span class="built_in">ulimit</span> -l unlimited` 命令 </span></span><br><span class="line">bootstrap.mlockall: true </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 确保 ES_MIN_MEM 和 ES_MAX_MEM 环境变量设置为相同的值,以及机器有足够的内存分配给Elasticsearch </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意:内存也不是越大越好,一般64位机器,最大分配内存别才超过32G </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############################# Network And HTTP ############################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置绑定的ip地址,可以是ipv4或ipv6的,默认为0.0.0.0 </span></span><br><span class="line">network.bind_host: 192.168.100.100   #只有本机可以访问http接口</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置其它节点和该节点交互的ip地址,如果不设置它会自动设置,值必须是个真实的ip地址 </span></span><br><span class="line">network.publish_host: 192.168.100.100 </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 同时设置bind_host和publish_host上面两个参数 </span></span><br><span class="line">network.host: 192.168.100.100    #绑定监听IP</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置节点间交互的tcp端口,默认是9300 </span></span><br><span class="line">transport.tcp.port: 9300 </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置是否压缩tcp传输时的数据，默认为<span class="literal">false</span>,不压缩</span></span><br><span class="line">transport.tcp.compress: true </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置对外服务的http端口,默认为9200 </span></span><br><span class="line">http.port: 9200 </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置请求内容的最大容量,默认100mb </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http.max_content_length: 100mb </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用http协议对外提供服务,默认为<span class="literal">true</span>,开启 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http.enabled: <span class="literal">false</span> </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##################### 使用head等插件监控集群信息，需要打开以下配置项 ###########</span></span></span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: "*"</span><br><span class="line">http.cors.allow-credentials: true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################## Gateway ################################### </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gateway的类型,默认为<span class="built_in">local</span>即为本地文件系统,可以设置为本地文件系统 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gateway.type: <span class="built_in">local</span> </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面的配置控制怎样以及何时启动一整个集群重启的初始化恢复过程 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (当使用shard gateway时,是为了尽可能的重用<span class="built_in">local</span> data(本地数据)) </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 一个集群中的N个节点启动后,才允许进行恢复处理 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gateway.recover_after_nodes: 1 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置初始化恢复过程的超时时间,超时时间从上一个配置中配置的N个节点启动后算起 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gateway.recover_after_time: 5m </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置这个集群中期望有多少个节点.一旦这N个节点启动(并且recover_after_nodes也符合), </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 立即开始恢复过程(不等待recover_after_time超时) </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gateway.expected_nodes: 2</span></span><br><span class="line"></span><br><span class="line"><span class="meta"> #</span><span class="bash"><span class="comment">############################ Recovery Throttling ############################# </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面这些配置允许在初始化恢复,副本分配,再平衡,或者添加和删除节点时控制节点间的分片分配 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置一个节点的并行恢复数 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1.初始化数据恢复时,并发恢复线程的个数,默认为4 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster.routing.allocation.node_initial_primaries_recoveries: 4 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.添加删除节点或负载均衡时并发恢复线程的个数,默认为2 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster.routing.allocation.node_concurrent_recoveries: 2 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置恢复时的吞吐量(例如:100mb,默认为0无限制.如果机器还有其他业务在跑的话还是限制一下的好) </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> indices.recovery.max_bytes_per_sec: 20mb </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置来限制从其它分片恢复数据时最大同时打开并发流的个数,默认为5 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> indices.recovery.concurrent_streams: 5 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意: 合理的设置以上参数能有效的提高集群节点的数据恢复以及初始化速度 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################# Discovery ################################## </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点.默认为1,对于大的集群来说,可以设置大一点的值(2-4) </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> discovery.zen.minimum_master_nodes: 1 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 探查的超时时间,默认3秒,提高一点以应对网络不好的时候,防止脑裂 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> discovery.zen.ping.timeout: 3s </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置是否打开多播发现节点.默认是<span class="literal">true</span>. (尽可能使用单播模式)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当多播不可用或者集群跨网段的时候集群通信还是用单播吧 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> discovery.zen.ping.multicast.enabled: <span class="literal">false</span> </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是一个集群中的主节点的初始列表,当节点(主节点或者数据节点)启动时使用这个列表进行探测 </span></span><br><span class="line">discovery.zen.ping.unicast.hosts: ["192.168.100.100:9300", "192.168.100.101:9300", "192.168.100.102:9300", "192.168.100.103:9300"] </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Slow Log部分与GC <span class="built_in">log</span>部分略,不过可以通过相关日志优化搜索查询速度 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###############  X-Pack ###########################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 官方插件 相关设置请查看此处</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# Memory(重点需要调优的部分) ################ </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Cache部分: </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> es有很多种方式来缓存其内部与索引有关的数据.其中包括filter cache </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> filter cache部分: </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> filter cache是用来缓存filters的结果的.默认的cache <span class="built_in">type</span>是node type.node <span class="built_in">type</span>的机制是所有的索引内部的分片共享filter cache.node <span class="built_in">type</span>采用的方式是LRU方式.即:当缓存达到了某个临界值之后，es会将最近没有使用的数据清除出filter cache.使让新的数据进入es. </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个临界值的设置方法如下：indices.cache.filter.size 值类型：eg.:512mb 20%。默认的值是10%。 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> out of memory错误避免过于频繁的查询时集群假死 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1.设置es的缓存类型为Soft Reference,它的主要特点是据有较强的引用功能.只有当内存不够的时候,才进行回收这类内存,因此在内存足够的时候,它们通常不被回收.另外,这些引用对象还能保证在Java抛出OutOfMemory异常之前,被设置为null.它可以用于实现一些常用图片的缓存,实现Cache的功能,保证最大限度的使用内存而不引起OutOfMemory.在es的配置文件加上index.cache.field.type: soft即可. </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.设置es最大缓存数据条数和缓存失效时间,通过设置index.cache.field.max_size: 50000来把缓存field的最大值设置为50000,设置index.cache.field.expire: 10m把过期时间设置成10分钟. </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> index.cache.field.max_size: 50000 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> index.cache.field.expire: 10m </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> index.cache.field.type: soft </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> field data部分&amp;&amp;circuit breaker部分： </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于fielddata缓存的内存数量,主要用于当使用排序,faceting操作时,elasticsearch会将一些热点数据加载到内存中来提供给客户端访问,但是这种缓存是比较珍贵的,所以对它进行合理的设置. </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以使用值：eg:50mb 或者 30％(节点 node heap内存量),默认是：unbounded <span class="comment">#indices.fielddata.cache.size： unbounded </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> field的超时时间.默认是-1,可以设置的值类型: 5m <span class="comment">#indices.fielddata.cache.expire: -1 </span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> circuit breaker部分: </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 断路器是elasticsearch为了防止内存溢出的一种操作,每一种circuit breaker都可以指定一个内存界限触发此操作,这种circuit breaker的设定有一个最高级别的设定:indices.breaker.total.limit 默认值是JVM heap的70%.当内存达到这个数量的时候会触发内存回收</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 另外还有两组子设置： </span></span><br><span class="line"><span class="meta">#</span><span class="bash">indices.breaker.fielddata.limit:当系统发现fielddata的数量达到一定数量时会触发内存回收.默认值是JVM heap的70% </span></span><br><span class="line"><span class="meta">#</span><span class="bash">indices.breaker.fielddata.overhead:在系统要加载fielddata时会进行预先估计,当系统发现要加载进内存的值超过<span class="built_in">limit</span> * overhead时会进行进行内存回收.默认是1.03 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">indices.breaker.request.limit:这种断路器是elasticsearch为了防止OOM(内存溢出),在每次请求数据时设定了一个固定的内存数量.默认值是40% </span></span><br><span class="line"><span class="meta">#</span><span class="bash">indices.breaker.request.overhead:同上,也是elasticsearch在发送请求时设定的一个预估系数,用来防止内存溢出.默认值是1 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Translog部分: </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 每一个分片(shard)都有一个transaction <span class="built_in">log</span>或者是与它有关的预写日志,(write <span class="built_in">log</span>),在es进行索引(index)或者删除(delete)操作时会将没有提交的数据记录在translog之中,当进行flush 操作的时候会将tranlog中的数据发送给Lucene进行相关的操作.一次flush操作的发生基于如下的几个配置 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">index.translog.flush_threshold_ops:当发生多少次操作时进行一次flush.默认是 unlimited <span class="comment">#index.translog.flush_threshold_size:当translog的大小达到此值时会进行一次flush操作.默认是512mb </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">index.translog.flush_threshold_period:在指定的时间间隔内如果没有进行flush操作,会进行一次强制flush操作.默认是30m <span class="comment">#index.translog.interval:多少时间间隔内会检查一次translog,来进行一次flush操作.es会随机的在这个值到这个值的2倍大小之间进行一次操作,默认是5s </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">index.gateway.local.sync:多少时间进行一次的写磁盘操作,默认是5s</span></span><br></pre></td></tr></table></figure>

<p>一般情况下，配置以下内容即可：编辑<code>elasticsearch.yml</code>文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@master config]# vi elasticsearch.yml</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加一下内容：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 集群名称</span></span><br><span class="line">cluster.name: zhiyou</span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点名称</span></span><br><span class="line">node.name: node0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 数据文件的路径</span></span><br><span class="line">path.data: /var/elasticsearch/data</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志文件的路径</span></span><br><span class="line">path.logs: /var/elasticsearch/log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 锁定内存</span></span><br><span class="line">bootstrap.memory_lock: false</span><br><span class="line"><span class="meta">#</span><span class="bash"> 本节点的IP即本机的IP</span></span><br><span class="line">network.host: 192.168.100.100</span><br><span class="line"><span class="meta">#</span><span class="bash"> 访问端口号，API交互的端口</span></span><br><span class="line">http.port: 9200</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置自动创建索引</span></span><br><span class="line">action.auto_create_index: true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置transport交互的IP和端口号</span></span><br><span class="line">transport.host: 192.168.100.100</span><br><span class="line">transport.tcp.port: 9300</span><br><span class="line">transport.tcp.compress: true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 单播模式发现其他节点，注意为9300端口</span></span><br><span class="line">discovery.zen.ping.unicast.hosts: ["192.168.100.100:9300", "192.168.100.101:9300", "192.168.100.102:9300", "192.168.100.103:9300"]</span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">discovery.zen.minimum_master_nodes: 3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置下面的参数，这样head插件才能使用</span></span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: "*"</span><br><span class="line">http.cors.allow-credentials: true</span><br></pre></td></tr></table></figure>

<h2 id="8-5-配置JVM"><a href="#8-5-配置JVM" class="headerlink" title="8.5 配置JVM"></a>8.5 配置JVM</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master config]# vi jvm.options</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改为以下设置：因为我的虚拟机给的内存为2G</span></span><br><span class="line">-Xms1g</span><br><span class="line">-Xmx1g</span><br></pre></td></tr></table></figure>

<h2 id="8-6-配置数据节点"><a href="#8-6-配置数据节点" class="headerlink" title="8.6 配置数据节点"></a>8.6 配置数据节点</h2><p>很明显，前面那一台节点咱们设置的是不存储数据的，一般来说咱们都会固定master节点，如果条件允许，可以多设置几台都行。在这里，我只配置了一台master节点，其余的三个节点设置为数据节点<br>在master节点上使用远程拷贝将elasticsearch主目录拷贝到其他节点上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master ES]# scp -r elasticsearch-5.6.3 root@192.168.100.101:/opt/SoftWare/ES/</span><br><span class="line">[root@master ES]# scp -r elasticsearch-5.6.3 root@192.168.100.102:/opt/SoftWare/ES/</span><br><span class="line">[root@master ES]# scp -r elasticsearch-5.6.3 root@192.168.100.103:/opt/SoftWare/ES/</span><br></pre></td></tr></table></figure>

<p>在数据节点上修改相关配置,其余的可以不修改了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 节点名称</span></span><br><span class="line">node.name: node1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 本节点的IP即本机的IP</span></span><br><span class="line">network.host: 192.168.100.101</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置transport交互的IP和端口号</span></span><br><span class="line">transport.host: 192.168.100.101</span><br></pre></td></tr></table></figure>

<h2 id="8-7-给数据节点创建相关目录并赋权限给es"><a href="#8-7-给数据节点创建相关目录并赋权限给es" class="headerlink" title="8.7 给数据节点创建相关目录并赋权限给es"></a>8.7 给数据节点创建相关目录并赋权限给es</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# mkdir -p /var/elasticsearch/log</span><br><span class="line">[root@master ~]# mkdir -p /var/elasticsearch/data</span><br><span class="line">[root@master ~]# chown -R es:es /opt/SoftWare/ES/elasticsearch-5.6.3</span><br><span class="line">[root@master ~]# chown -R es:es /var/elasticsearch/log</span><br><span class="line">[root@master ~]# chown -R es:es /var/elasticsearch/data</span><br></pre></td></tr></table></figure>

<h2 id="8-8-修改系统配置文件（每台节点均需要配置并重启生效）"><a href="#8-8-修改系统配置文件（每台节点均需要配置并重启生效）" class="headerlink" title="8.8 修改系统配置文件（每台节点均需要配置并重启生效）"></a>8.8 修改系统配置文件（每台节点均需要配置并重启生效）</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">编辑文件1：/etc/security/limits.conf</span></span><br><span class="line">[root@slave3 ~]# vi /etc/security/limits.conf   添加以下内容</span><br><span class="line">*       hard    nofile  131072</span><br><span class="line">*       soft    nofile  65536</span><br><span class="line">*       hard    nproc   4096</span><br><span class="line">*       soft    nproc   2048</span><br><span class="line">es      soft    memlock unlimited</span><br><span class="line">es      hard    memlock unlimited</span><br><span class="line"><span class="meta">#</span><span class="bash">编辑文件1：/etc/sysctl.conf    添加以下内容</span></span><br><span class="line">[root@slave3 ~]# vi /etc/sysctl.conf</span><br><span class="line">vm.max_map_count=262144</span><br></pre></td></tr></table></figure>

<h2 id="8-9-可能的错误集锦："><a href="#8-9-可能的错误集锦：" class="headerlink" title="8.9 可能的错误集锦："></a>8.9 可能的错误集锦：</h2><h3 id="8-9-1-can-not-run-elasticsearch-as-root"><a href="#8-9-1-can-not-run-elasticsearch-as-root" class="headerlink" title="8.9.1 can not run elasticsearch as root"></a>8.9.1 can not run elasticsearch as root</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">错误详情：</span></span><br><span class="line">[2017-11-01T10:32:44,124][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [node2] uncaught exception in thread [main]</span><br><span class="line">org.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root</span><br><span class="line"><span class="meta">#</span><span class="bash">解决方案：</span></span><br><span class="line">不要使用root用户启动，使用非root用户启动方可解决问题</span><br></pre></td></tr></table></figure>

<h3 id="8-9-2-Unable-to-lock-JVM-Memory-error-12-reason-无法分配内存"><a href="#8-9-2-Unable-to-lock-JVM-Memory-error-12-reason-无法分配内存" class="headerlink" title="8.9.2 Unable to lock JVM Memory: error=12, reason=无法分配内存"></a>8.9.2 Unable to lock JVM Memory: error=12, reason=无法分配内存</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">错误详情：</span></span><br><span class="line">[2017-11-01T10:32:04,993][WARN ][o.e.b.JNANatives         ] Unable to lock JVM Memory: error=12, reason=无法分配内存</span><br><span class="line">[2017-11-01T10:32:04,998][WARN ][o.e.b.JNANatives         ] This can result in part of the JVM being swapped out.</span><br><span class="line">[2017-11-01T10:32:04,998][WARN ][o.e.b.JNANatives         ] Increase RLIMIT_MEMLOCK, soft limit: 65536, hard limit: 65536</span><br><span class="line">[2017-11-01T10:32:04,998][WARN ][o.e.b.JNANatives         ] These can be adjusted by modifying /etc/security/limits.conf, for example: </span><br><span class="line"><span class="meta">	#</span><span class="bash"> allow user <span class="string">'es'</span> mlockall</span></span><br><span class="line">	es soft memlock unlimited</span><br><span class="line">	es hard memlock unlimited</span><br><span class="line"><span class="meta">#</span><span class="bash">解决方案：</span></span><br><span class="line">编辑文件/etc/security/limits.conf，添加一下内容（重启生效）</span><br><span class="line">[root@slave3 ~]# vi /etc/security/limits.conf</span><br><span class="line">es      soft    memlock unlimited</span><br><span class="line">es      hard    memlock unlimited</span><br></pre></td></tr></table></figure>

<h3 id="8-9-3-ERROR-1-bootstrap-checks-failed"><a href="#8-9-3-ERROR-1-bootstrap-checks-failed" class="headerlink" title="8.9.3 ERROR: [1] bootstrap checks failed"></a>8.9.3 ERROR: [1] bootstrap checks failed</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">错误详情：</span></span><br><span class="line">[2017-11-01T11:18:54,289][INFO ][o.e.b.BootstrapChecks    ] [node3] bound or publishing to a non-loopback or non-link-local address, enforcing bootstrap checks</span><br><span class="line">ERROR: [1] bootstrap checks failed</span><br><span class="line">[1]: max file descriptors [4096] for elasticsearch process is too low, increase to at least [65536]</span><br><span class="line"><span class="meta">#</span><span class="bash">解决方案：</span></span><br><span class="line">编辑文件/etc/security/limits.conf，添加以下内容（重启生效）</span><br><span class="line">[root@slave3 ~]# vi /etc/security/limits.conf</span><br><span class="line">*       hard    nofile  131072</span><br><span class="line">*       soft    nofile  65536</span><br><span class="line">*       hard    nproc   4096</span><br><span class="line">*       soft    nproc   2048</span><br></pre></td></tr></table></figure>

<h3 id="8-9-4-ERROR-1-bootstrap-checks-failed"><a href="#8-9-4-ERROR-1-bootstrap-checks-failed" class="headerlink" title="8.9.4 ERROR: [1] bootstrap checks failed"></a>8.9.4 ERROR: [1] bootstrap checks failed</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">错误详情：</span></span><br><span class="line">[2017-11-01T11:18:54,289][INFO ][o.e.b.BootstrapChecks    ] [node3] bound or publishing to a non-loopback or non-link-local address, enforcing bootstrap checks</span><br><span class="line">ERROR: [1] bootstrap checks failed</span><br><span class="line">[1]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</span><br><span class="line"><span class="meta">#</span><span class="bash">解决方案：</span></span><br><span class="line">编辑文件/etc/sysctl.conf，添加以下内容（重启生效）</span><br><span class="line">[root@slave3 ~]# vi /etc/sysctl.conf</span><br><span class="line">vm.max_map_count=262144</span><br></pre></td></tr></table></figure>

<h3 id="8-9-5-access-denied-“javax-management-MBeanTrustPermission”-“register”"><a href="#8-9-5-access-denied-“javax-management-MBeanTrustPermission”-“register”" class="headerlink" title="8.9.5 access denied (“javax.management.MBeanTrustPermission” “register”)"></a>8.9.5 access denied (“javax.management.MBeanTrustPermission” “register”)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">错误详情：</span></span><br><span class="line">2017-11-01 10:46:27,754 main ERROR Could not register mbeans java.security.AccessControlException: access denied ("javax.management.MBeanTrustPermission" "register")</span><br><span class="line">	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)</span><br><span class="line">	at java.lang.SecurityManager.checkPermission(SecurityManager.java:585)</span><br><span class="line">	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.checkMBeanTrustPermission(DefaultMBeanServerInterceptor.java:1848)</span><br><span class="line"><span class="meta">#</span><span class="bash">解决方案：</span></span><br><span class="line">给elasticsearch-5.6.3的主目录分配权限</span><br><span class="line">[es@master elasticsearch-5.6.3]$ sudo chown -R es:es elasticsearch-5.6.3</span><br></pre></td></tr></table></figure>

<h2 id="8-10-测试集群环境是否搭建成功"><a href="#8-10-测试集群环境是否搭建成功" class="headerlink" title="8.10 测试集群环境是否搭建成功"></a>8.10 测试集群环境是否搭建成功</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">每台节点都进入到es主目录，使用es用户</span></span><br><span class="line">[es@master elasticsearch-5.6.3]# bin/elasticsearch</span><br><span class="line"><span class="meta">#</span><span class="bash">在浏览器的地址栏中输入</span></span><br><span class="line">http://192.168.100.103:9200/</span><br><span class="line"><span class="meta">#</span><span class="bash">出现以下内容，说明当前es节点已启动</span></span><br><span class="line">&#123;</span><br><span class="line">  "name" : "node3",</span><br><span class="line">  "cluster_name" : "zhiyou",</span><br><span class="line">  "cluster_uuid" : "7kO5OPi8RoWUuXfEBYPITw",</span><br><span class="line">  "version" : &#123;</span><br><span class="line">    "number" : "5.6.3",</span><br><span class="line">    "build_hash" : "1a2f265",</span><br><span class="line">    "build_date" : "2017-10-06T20:33:39.012Z",</span><br><span class="line">    "build_snapshot" : false,</span><br><span class="line">    "lucene_version" : "6.6.1"</span><br><span class="line">  &#125;,</span><br><span class="line">  "tagline" : "You Know, for Search"</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">在浏览器中输入</span></span><br><span class="line">http://192.168.100.100:9200/_cluster/health</span><br><span class="line"><span class="meta">#</span><span class="bash">出现以下内容，说明es集群已搭建成功（看status和number_of_nodes是否准确）</span></span><br><span class="line">&#123;"cluster_name":"zhiyou","status":"green","timed_out":false,"number_of_nodes":4,"number_of_data_nodes":4,"active_primary_shards":0,"active_shards":0,"relocating_shards":0,"initializing_shards":0,"unassigned_shards":0,"delayed_unassigned_shards":0,"number_of_pending_tasks":0,"number_of_in_flight_fetch":0,"task_max_waiting_in_queue_millis":0,"active_shards_percent_as_number":100.0&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-安装Head插件"><a href="#9-安装Head插件" class="headerlink" title="#9. 安装Head插件"></a>#9. 安装Head插件</h2><h2 id="9-1-下载"><a href="#9-1-下载" class="headerlink" title="9.1 下载"></a>9.1 下载</h2><p><a href="https://codeload.github.com/mobz/elasticsearch-head/zip/master" target="_blank" rel="noopener">点击下载</a></p>
<h2 id="9-2-解压"><a href="#9-2-解压" class="headerlink" title="9.2 解压"></a>9.2 解压</h2><p>由于最小化安装，故没有解压zip文件的命令，首先安装unzip解压软件，然后再进行解压</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[es@master plugins]$ sudo yum install zip unzip</span><br><span class="line">[es@master plugins]$ unzip elasticsearch-head-master.zip</span><br></pre></td></tr></table></figure>

<h2 id="9-3-安装HTTP"><a href="#9-3-安装HTTP" class="headerlink" title="9.3 安装HTTP"></a>9.3 安装HTTP</h2><p>由于这个插件就是HTML5写的，就是一个前端的一个东西，只需要set到HTTP服务中即可</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装HTTP</span></span><br><span class="line">[es@master plugins]$ sudo yum install httpd -y</span><br></pre></td></tr></table></figure>

<h2 id="9-4-复制head到HTTP的指定目录"><a href="#9-4-复制head到HTTP的指定目录" class="headerlink" title="9.4 复制head到HTTP的指定目录"></a>9.4 复制head到HTTP的指定目录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[es@master ~]$ cd /var/www/html</span><br><span class="line">[es@master html]$ sudo cp -r /opt/SoftWare/ES/plugins/head /var/www/html/</span><br></pre></td></tr></table></figure>

<h2 id="9-5-启动ES集群和HTTPD服务"><a href="#9-5-启动ES集群和HTTPD服务" class="headerlink" title="9.5 启动ES集群和HTTPD服务"></a>9.5 启动ES集群和HTTPD服务</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[es@master ~]# sudo systemctl restart httpd</span><br></pre></td></tr></table></figure>

<p>访问IP地址如下说明已经启动，可以设置开机自启<br>![image_1btt80jm0qspmmrk121ksqp559.png-555.7kB][1]</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动ES集群</span></span><br><span class="line">[es@master ~]# cd /opt/SoftWare/ES/elasticsearch-5.6.3</span><br><span class="line">[es@master elasticsearch-5.6.3]# bin/elasticsearch</span><br></pre></td></tr></table></figure>

<p>出现下面的类似界面<br>![image_1btt9a90v8qaqfo1a5i130htnm.png-111.2kB][2]</p>
<h1 id="10-安装Kibana"><a href="#10-安装Kibana" class="headerlink" title="10. 安装Kibana"></a>10. 安装Kibana</h1><hr>
<h2 id="10-1-下载"><a href="#10-1-下载" class="headerlink" title="10.1 下载"></a>10.1 下载</h2><p><a href="https://artifacts.elastic.co/downloads/kibana/kibana-5.6.3-linux-x86_64.tar.gz" target="_blank" rel="noopener">单击下载</a></p>
<h2 id="10-2-解压"><a href="#10-2-解压" class="headerlink" title="10.2 解压"></a>10.2 解压</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master Kibana]# tar kibana-5.6.3-linux-x86_64.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 名字太长了也不好，就mv一下了</span></span><br><span class="line">[root@master Kibana]# mv kibana-5.6.3-linux-x86_64 kibana-5.6.3</span><br></pre></td></tr></table></figure>

<h2 id="10-3-配置"><a href="#10-3-配置" class="headerlink" title="10.3 配置"></a>10.3 配置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@master Kibana]# cd kibana-5.6.3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">修改一下内容即可</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Kibana服务端口</span></span><br><span class="line">server.port: 5601</span><br><span class="line"><span class="meta">#</span><span class="bash"> kibana访问的IP</span></span><br><span class="line">server.host: "192.168.100.100"</span><br><span class="line"><span class="meta">#</span><span class="bash">elasticsearch的master地址</span></span><br><span class="line">elasticsearch.url: "http://192.168.100.100:9200"</span><br><span class="line"><span class="meta">#</span><span class="bash">kibana默认的元数据索引</span></span><br><span class="line">kibana.index: ".kibana"</span><br></pre></td></tr></table></figure>

<h2 id="10-4-启动Kibana"><a href="#10-4-启动Kibana" class="headerlink" title="10.4 启动Kibana"></a>10.4 启动Kibana</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master kibana-5.6.3]# bin/kibana</span><br></pre></td></tr></table></figure>

<p>出现下面的界面，可能会因为数据的问题有点不一样<br>![image_1btta457a3d01e371c3fn3c1dav13.png-45.8kB][3]<br>![image_1btta50r5vikqra135r1dv7lfp20.png-199.8kB][4]<br>第一次启动会提示配置一个索引，其实就是默认的一个搜索位置</p>
<h1 id="11-安装Logstash"><a href="#11-安装Logstash" class="headerlink" title="11. 安装Logstash"></a>11. 安装Logstash</h1><hr>
<h2 id="11-1-下载Logstash"><a href="#11-1-下载Logstash" class="headerlink" title="11.1 下载Logstash"></a>11.1 下载Logstash</h2><p><a href="https://artifacts.elastic.co/downloads/logstash/logstash-5.6.3.tar.gz" target="_blank" rel="noopener">点击下载</a></p>
<h2 id="11-2-解压缩"><a href="#11-2-解压缩" class="headerlink" title="11.2 解压缩"></a>11.2 解压缩</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master Logstash]# tar -zxvf logstash-5.6.3.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="11-3-运行Logstash"><a href="#11-3-运行Logstash" class="headerlink" title="11.3 运行Logstash"></a>11.3 运行Logstash</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在这里可以使用标准输入线测试一下logstash</span></span><br><span class="line">[root@master logstash-5.6.3]# bin/logstash -e 'input &#123; stdin&#123;&#125; &#125; output &#123;stdout&#123;&#125; &#125;'</span><br></pre></td></tr></table></figure>

<p>出现下面的内容说明启动成功<br>![image_1bttcndg518kq1enu8tg3v14f32d.png-16.1kB][5]<br>然后练习以下输入输出</p>
<h3 id="11-3-1-codec"><a href="#11-3-1-codec" class="headerlink" title="11.3.1 codec"></a>11.3.1 codec</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master logstash-5.6.3]# bin/logstash -e 'input &#123; stdin&#123;&#125; &#125; output &#123;stdout&#123;codec =&gt; rubydebug&#125; &#125;'</span><br></pre></td></tr></table></figure>

<p>![image_1bttcvo60152g36i5oa19ei1u7v2q.png-45.7kB][6]</p>
<h3 id="11-3-2-输出es集群中"><a href="#11-3-2-输出es集群中" class="headerlink" title="11.3.2 输出es集群中"></a>11.3.2 输出es集群中</h3><p>注意：老版本和新版本不同，注意看<a href="https://www.elastic.co/guide/en/logstash/current/config-examples.html" target="_blank" rel="noopener">官方文档</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master logstash-5.6.3]# bin/logstash -e 'input &#123; stdin&#123;&#125; &#125; output &#123;elasticsearch &#123; hosts =&gt; ["192.168.100.100:9200"] &#125; stdout&#123;&#125; &#125;'</span><br></pre></td></tr></table></figure>

<h1 id="12-使用ELK进行整合操作"><a href="#12-使用ELK进行整合操作" class="headerlink" title="12. 使用ELK进行整合操作"></a>12. 使用ELK进行整合操作</h1><h2 id="12-1-编写数据读取的配置文件"><a href="#12-1-编写数据读取的配置文件" class="headerlink" title="12.1 编写数据读取的配置文件"></a>12.1 编写数据读取的配置文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master logstash-5.6.3]# vi /var/logstash/config/std.conf</span><br></pre></td></tr></table></figure>

<p>添加如下内容</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line"> stdin &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line"> elasticsearch &#123;</span><br><span class="line">   hosts =&gt; ["192.168.100.100:9200"]</span><br><span class="line"> &#125;</span><br><span class="line"> stdout &#123;</span><br><span class="line">   codec =&gt; rubydebug</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>应用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master logstash-5.6.3]# bin/logstash -f /var/logstash/config/std.conf</span><br></pre></td></tr></table></figure>

<h2 id="12-2-file输入详解"><a href="#12-2-file输入详解" class="headerlink" title="12.2 file输入详解"></a>12.2 file输入详解</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">监听文件的路径</span></span><br><span class="line">path =&gt; ["/var/logstash/data/*","/var/logstash/test.log"]</span><br><span class="line"><span class="meta">#</span><span class="bash">排除不想监听的文件</span></span><br><span class="line">exclude =&gt; "1.log"</span><br><span class="line"><span class="meta">#</span><span class="bash">添加自定义的字段</span></span><br><span class="line">add_field =&gt; &#123;"test"=&gt;"test"&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">增加标签</span></span><br><span class="line">tags =&gt; "tag1"</span><br><span class="line"><span class="meta">#</span><span class="bash">设置新事件的标志</span></span><br><span class="line">delimiter =&gt; "\n"</span><br><span class="line"><span class="meta">#</span><span class="bash">设置多长时间扫描目录，发现新文件</span></span><br><span class="line">discover_interval =&gt; 15</span><br><span class="line"><span class="meta">#</span><span class="bash">设置多长时间检测文件是否修改</span></span><br><span class="line">stat_interval =&gt; 1</span><br><span class="line"><span class="meta">#</span><span class="bash">监听文件的起始位置，默认是end</span></span><br><span class="line">start_position =&gt; beginning</span><br><span class="line"><span class="meta">#</span><span class="bash">监听文件读取信息记录的位置</span></span><br><span class="line">sincedb_path =&gt; "/var/logstash/test.log"</span><br><span class="line"><span class="meta">#</span><span class="bash">设置多长时间会写入读取的位置信息</span></span><br><span class="line">sincedb_write_interval =&gt; 15</span><br></pre></td></tr></table></figure>

<p>  <img src="http://static.zybuluo.com/zhangwen100/psxk09q4hdm57j07beib6h3p/image_1btt80jm0qspmmrk121ksqp559.png" alt="1"><br>  <img src="http://static.zybuluo.com/zhangwen100/f6ich2owz7dnzerr0t0t6mep/image_1btt9a90v8qaqfo1a5i130htnm.png" alt="2"><br>  <img src="http://static.zybuluo.com/zhangwen100/rhssfvrdloocdimd8tcvt4ln/image_1btta457a3d01e371c3fn3c1dav13.png" alt="3"><br> <img src="http://static.zybuluo.com/zhangwen100/jbknyal00b9licrsl01ekc5h/image_1btta50r5vikqra135r1dv7lfp20.png" alt="4"><br>  <img src="http://static.zybuluo.com/zhangwen100/4a1srf8cinw3a5mqdn964gyw/image_1bttcndg518kq1enu8tg3v14f32d.png" alt="5"><br>  <img src="http://static.zybuluo.com/zhangwen100/92eyje4tnjw7wa51bruesb9n/image_1bttcvo60152g36i5oa19ei1u7v2q.png" alt="6"><br>  <img src="http://static.zybuluo.com/zhangwen100/cfwumzoreip8u0snqqu0ajcc/image_1c12nrt1g12vc1na5nki1isrfoc16.png" alt="7"></p>

      
    </div>
    
    
    

    

    

    


<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
  
</div>




    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ELK/" rel="tag"><i class="fa fa-tag"></i> ELK</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/25/1_数据仓库/" rel="next" title="大数据-数据仓库">
                <i class="fa fa-chevron-left"></i> 大数据-数据仓库
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/25/1_Linux第一天__/" rel="prev" title="Linux第一天">
                Linux第一天 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MzQ4MC8yMDAyMA"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/ggg.jpg" alt="Ckm_zz">
            
              <p class="site-author-name" itemprop="name">Ckm_zz</p>
              <p class="site-description motion-element" itemprop="description">—— not too bad luck</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">69</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">60</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zzckm" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://www.totree.cn" target="_blank" title="To树商城">
                      
                        <i class="fa fa-fw fa-skype"></i></a>
                  </span>
                
            </div>
          
<!-- 音乐播放器 -->
 
           <div>
              <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="210" height="110" src="//music.163.com/outchain/player?type=2&id=3932159&auto=1&height=66"></iframe>
           </div>
 

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ELK安装文档"><span class="nav-number">1.</span> <span class="nav-text">ELK安装文档</span></a></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#1-安装准备"><span class="nav-number"></span> <span class="nav-text">1. 安装准备</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-操作环境"><span class="nav-number">1.</span> <span class="nav-text">1.1 操作环境</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-安装上传文件和下载文件的插件（可以不安装）"><span class="nav-number"></span> <span class="nav-text">2. 安装上传文件和下载文件的插件（可以不安装）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-安装sudo命令并配置"><span class="nav-number"></span> <span class="nav-text">3. 安装sudo命令并配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-安装sudo插件"><span class="nav-number">1.</span> <span class="nav-text">3.1 安装sudo插件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-修改-etc-sudoers文件的权限"><span class="nav-number">2.</span> <span class="nav-text">3.2 修改/etc/sudoers文件的权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-开始编辑-etc-sudoers文件"><span class="nav-number">3.</span> <span class="nav-text">3.3 开始编辑/etc/sudoers文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-找到root-ALL-ALL-ALL行，在下面添加如下内容"><span class="nav-number">4.</span> <span class="nav-text">3.4 找到root    ALL=(ALL)       ALL行，在下面添加如下内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-去掉-wheel-ALL-ALL-NOPASSWD-ALL的-号"><span class="nav-number">5.</span> <span class="nav-text">3.5 去掉#%wheel  ALL=(ALL)         NOPASSWD: ALL的#号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-保存并退出"><span class="nav-number">6.</span> <span class="nav-text">3.6 保存并退出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7将es用户调整至wheel用户组中，这样以后使用sudo命令的时候就不用输入密码了。"><span class="nav-number">7.</span> <span class="nav-text">3.7将es用户调整至wheel用户组中，这样以后使用sudo命令的时候就不用输入密码了。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-8-恢复-etc-sudoers文件的权限"><span class="nav-number">8.</span> <span class="nav-text">3.8 恢复/etc/sudoers文件的权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-切换至es用户"><span class="nav-number">9.</span> <span class="nav-text">#4. 切换至es用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-创建相应目录"><span class="nav-number">10.</span> <span class="nav-text">#5. 创建相应目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-关闭防火墙"><span class="nav-number">11.</span> <span class="nav-text">#6. 关闭防火墙</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-安装jdk环境"><span class="nav-number">12.</span> <span class="nav-text">#7. 安装jdk环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-上传tar包"><span class="nav-number">13.</span> <span class="nav-text">7.1 上传tar包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-卸载JDK"><span class="nav-number">14.</span> <span class="nav-text">7.1 卸载JDK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-解压jdk"><span class="nav-number">15.</span> <span class="nav-text">7.2 解压jdk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-配置环境变量"><span class="nav-number">16.</span> <span class="nav-text">7.3 配置环境变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-将master节点上的jdk远程拷贝到其他节点上"><span class="nav-number">17.</span> <span class="nav-text">7.4 将master节点上的jdk远程拷贝到其他节点上</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Elasticsearch的安装"><span class="nav-number">18.</span> <span class="nav-text">#8. Elasticsearch的安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-将Elasticsearch上传至VM"><span class="nav-number">19.</span> <span class="nav-text">8.1 将Elasticsearch上传至VM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-解压Elasticsearch压缩包"><span class="nav-number">20.</span> <span class="nav-text">8.2 解压Elasticsearch压缩包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-创建相关目录并赋权限给es"><span class="nav-number">21.</span> <span class="nav-text">8.3 创建相关目录并赋权限给es</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-配置核心文件"><span class="nav-number">22.</span> <span class="nav-text">8.4 配置核心文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-5-配置JVM"><span class="nav-number">23.</span> <span class="nav-text">8.5 配置JVM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-6-配置数据节点"><span class="nav-number">24.</span> <span class="nav-text">8.6 配置数据节点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-7-给数据节点创建相关目录并赋权限给es"><span class="nav-number">25.</span> <span class="nav-text">8.7 给数据节点创建相关目录并赋权限给es</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-8-修改系统配置文件（每台节点均需要配置并重启生效）"><span class="nav-number">26.</span> <span class="nav-text">8.8 修改系统配置文件（每台节点均需要配置并重启生效）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-9-可能的错误集锦："><span class="nav-number">27.</span> <span class="nav-text">8.9 可能的错误集锦：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-1-can-not-run-elasticsearch-as-root"><span class="nav-number">27.1.</span> <span class="nav-text">8.9.1 can not run elasticsearch as root</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-2-Unable-to-lock-JVM-Memory-error-12-reason-无法分配内存"><span class="nav-number">27.2.</span> <span class="nav-text">8.9.2 Unable to lock JVM Memory: error=12, reason=无法分配内存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-3-ERROR-1-bootstrap-checks-failed"><span class="nav-number">27.3.</span> <span class="nav-text">8.9.3 ERROR: [1] bootstrap checks failed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-4-ERROR-1-bootstrap-checks-failed"><span class="nav-number">27.4.</span> <span class="nav-text">8.9.4 ERROR: [1] bootstrap checks failed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-5-access-denied-“javax-management-MBeanTrustPermission”-“register”"><span class="nav-number">27.5.</span> <span class="nav-text">8.9.5 access denied (“javax.management.MBeanTrustPermission” “register”)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-10-测试集群环境是否搭建成功"><span class="nav-number">28.</span> <span class="nav-text">8.10 测试集群环境是否搭建成功</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-安装Head插件"><span class="nav-number">29.</span> <span class="nav-text">#9. 安装Head插件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-下载"><span class="nav-number">30.</span> <span class="nav-text">9.1 下载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-解压"><span class="nav-number">31.</span> <span class="nav-text">9.2 解压</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-3-安装HTTP"><span class="nav-number">32.</span> <span class="nav-text">9.3 安装HTTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-4-复制head到HTTP的指定目录"><span class="nav-number">33.</span> <span class="nav-text">9.4 复制head到HTTP的指定目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-5-启动ES集群和HTTPD服务"><span class="nav-number">34.</span> <span class="nav-text">9.5 启动ES集群和HTTPD服务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-安装Kibana"><span class="nav-number"></span> <span class="nav-text">10. 安装Kibana</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#10-1-下载"><span class="nav-number">1.</span> <span class="nav-text">10.1 下载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-2-解压"><span class="nav-number">2.</span> <span class="nav-text">10.2 解压</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-3-配置"><span class="nav-number">3.</span> <span class="nav-text">10.3 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-4-启动Kibana"><span class="nav-number">4.</span> <span class="nav-text">10.4 启动Kibana</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-安装Logstash"><span class="nav-number"></span> <span class="nav-text">11. 安装Logstash</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#11-1-下载Logstash"><span class="nav-number">1.</span> <span class="nav-text">11.1 下载Logstash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-2-解压缩"><span class="nav-number">2.</span> <span class="nav-text">11.2 解压缩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-3-运行Logstash"><span class="nav-number">3.</span> <span class="nav-text">11.3 运行Logstash</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#11-3-1-codec"><span class="nav-number">3.1.</span> <span class="nav-text">11.3.1 codec</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-3-2-输出es集群中"><span class="nav-number">3.2.</span> <span class="nav-text">11.3.2 输出es集群中</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-使用ELK进行整合操作"><span class="nav-number"></span> <span class="nav-text">12. 使用ELK进行整合操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#12-1-编写数据读取的配置文件"><span class="nav-number">1.</span> <span class="nav-text">12.1 编写数据读取的配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-2-file输入详解"><span class="nav-number">2.</span> <span class="nav-text">12.2 file输入详解</span></a></li></ol></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">©2019 by ZZckm</span>

  
</div>








  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>






        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      访客量
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  


  <!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

<!-- 鼠标点击爆炸烟花效果 -->

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":180,"height":330},"mobile":{"show":true},"log":false});</script></body>
</html>
